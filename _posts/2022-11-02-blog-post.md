---
title: "Matrix code rain 만들기"
date: 2022-11-02
permalink: /posts/2022-11-02-blog-post/
type: posts
tags:
  - CSS
  - HTML
  - JS
  - Animation
---

## Matrix Code Rain 을 구현해보려고 한다.

<iframe width="560" height="315" src="https://www.youtube.com/embed/rpWrtXyEAN0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

최초 계획은, transform으로 글자를 변형시켜서 비처럼 떨어지게 할 생각이었으나, 그렇게 되면, 글자 한글자 한글자 마다 수시로 바뀌어야 하는, 모션 특성상 부하가 많아질 것 같아서, canvas 에서 구현하는 방향으로 변경.
but 다음의 내용을 알게 되었다.

- text glowing 효과 -> text-shadow
- text gradation 효과 -> background-image, background-clop, web-kit-text-fill-color, background-size 콤비네이션 이용

```
// 예제
2. background-image, webkit-background-clip,web-kit-text-fill-color, background-size 콤비네이션을 사용한다.(transform: rotation과 궁합이 좋지 않다.)

  background-image: gradation();

  // 브라우저가 webkit 계열이 아닌경우에는, 속성이 안먹으니까, 그냥 컬러로 단색 톤으로 나오게 처리를 해둔다.
  background-clip(fallback)
  color:green(fallback);



  // webkit브라우저에서만 작동
  web-kit-text-fill-color: transparent;
  web-kit-background-clip: text;
```

- text에 glowing effect를 적용해서, 글자가 위에서 아래쪽으로 떨어질 때, 글자의 머리 부분과, 꼬리 부분에 효과를 적용해 주려고 한다.

  1. text가 꼬리 부분은 옅어야 하고, 머리부분은 빛이 나야 한다.

---

### 해결했어야 하는 문제들

1. canvas위에서 종방향(세로)으로 글자쓰기
2. 글자들이 비처럼 떨어지게 어떻게 할 것인가

```
2-1
최초 글자의 높이를 y라고 했을 때, y가 초당 몇회 이상 위치를 조금씩 이동하면, 애니메이션효과가 적용된 것 처럼 보일 것이다.

초당 위치를 변경한 횟수를 프레임이라고 표현하면, 프레임이 많을 수록, 더 매끄러운 움직으로 보일 것이다.

글자 하나를 찍을 때 y값을 짧은시간동안, 증가시켜주게 되면, canvas 상에서, 세로 방향으로 움직이는 글자를 볼 수 있다.
setTimeout, recursion 같은 아이디어를 활용하면 구현할 수 있다.

2-2
그렇다면 여러개의 문자열을 써야 한다면 어떨까
canvas에서 세로 방향으로 글을 적으려면, canvas 자체를 90도 회전시키던가, 문자열을 찍을 때 y값을 계산해서 종방향으로 찍힐 수 있도록, 해야 한다.

y값을 증가시켜 가면서, 종방향으로 문자를 하나씩 하나씩 찍으면, 종방향 문자열을 만들 수가 있다.

2-3
2-1, 2-2 를 종합하게 되면,
code rain 을 만들수가 있다.
중요한 사실은 y값을 사실 2번 계산하는 것이다.
한번은 문자열이 시작하는 위치를 잡기 위해서, y1를 계산하는 것이고, 이 y1을 이용해서, 세로방향으로 문자열을 찍기 위해서, 다시 y값을 각각의 character의 height 값만 큼 증가시켜서, 문자열을 찍게 되는 것이다.
![예시](assets/images/code_rain2.gif)





```

구현내용: [https://github.com/jimyeong/animations](https://github.com/jimyeong/animations)
